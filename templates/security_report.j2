{# Security Report Template
   Generated by Ansible
   This template creates a comprehensive security report including:
   - System information
   - ClamAV antivirus scan results
   - RKHunter rootkit detection results
   - Network security information
#}

Security Scan Report
===================
Generated: {{ ansible_date_time.iso8601 }}

System Information
-----------------
Hostname: {{ ansible_hostname }}
OS: {{ ansible_distribution }} {{ ansible_distribution_version }}
Kernel: {{ ansible_kernel }}
Last Update: {{ ansible_date_time.date }}

Antivirus Scan Results (ClamAV)
------------------------------
Scan Started: {{ scan_data.clamav.start_time | default('N/A') }}
{% if scan_data.clamav.stdout | length > 0 %}
{{ scan_data.clamav.stdout }}
{% else %}
No threats detected
{% endif %}

Rootkit Detection (RKHunter)
---------------------------
{% if scan_data.rkhunter.stdout | length > 0 %}
{{ scan_data.rkhunter.stdout }}
{% else %}
No rootkits detected
{% endif %}

Network Security
---------------
Open Ports and Services:
{% if scan_data.open_ports.stdout | length > 0 %}
{{ scan_data.open_ports.stdout }}
{% else %}
No open ports detected
{% endif %}

System Updates
-------------
Security Updates Available: {{ security_updates | default('Unknown') }}
Last Security Patch: {{ last_security_patch | default('Unknown') }}

Additional Security Metrics
-------------------------
Failed SSH Attempts (24h): {{ failed_ssh_attempts | default('N/A') }}
System Integrity Check: {{ integrity_check_status | default('Not performed') }}

{# Footer with report integrity hash #}
---
Report Hash: {{ '%Y%m%d' | strftime | hash('sha256') }}
